<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Coffee Menu</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
  body {
    font-family: system-ui, sans-serif;
    background: #fff;
    margin: 0;
    padding: 0;
  }

  h1 {
    text-align: center;
    padding: 1rem;
    border-bottom: 1px solid #eee;
  }

  .menu-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    margin: 10px;
    padding: 10px;
  }

  .menu-left {
    display: flex;
    align-items: center;
    flex: 1;
  }

  .menu-left img {
    width: 80px;
    height: 80px;
    border-radius: 10px;
    object-fit: cover;
    margin-right: 10px;
  }

  .menu-info {
    display: flex;
    flex-direction: column;
  }

  .menu-info strong {
    font-size: 1rem;
  }

  .menu-info span {
    color: #666;
    font-size: 0.9rem;
  }

  .menu-right {
    display: flex;
    flex-direction: column;
    gap: 5px;
    align-items: flex-end;
  }

  select, input {
    padding: 4px;
    border-radius: 6px;
    border: 1px solid #ddd;
  }

  button.add {
    background: #007bff;
    color: #fff;
    border: none;
    border-radius: 8px;
    padding: 5px 12px;
    cursor: pointer;
  }

  /* Floating Cart */
  .cart-btn {
    position: fixed;
    right: 20px;
    bottom: 20px;
    background: #00a884;
    color: white;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    cursor: pointer;
    z-index: 5;
  }

  .cart-count {
    position: absolute;
    top: 6px;
    right: 6px;
    background: red;
    color: white;
    border-radius: 50%;
    padding: 2px 7px;
    font-size: 12px;
  }

  /* Popup background */
  .popup-bg {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(5px);
    justify-content: center;
    align-items: center;
    z-index: 10;
  }

  /* Popup box */
  .popup {
    background: white;
    border-radius: 15px;
    padding: 20px;
    width: 90%;
    max-width: 400px;
    text-align: center;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  }

  .popup h2 {
    margin-top: 0;
  }

  .popup button {
    background: #00a884;
    color: white;
    border: none;
    border-radius: 8px;
    padding: 10px 20px;
    margin-top: 10px;
    cursor: pointer;
  }

  .popup .close-btn {
    background: #ddd;
    color: #333;
    margin-right: 10px;
  }

  img.qr {
    width: 100%;
    border-radius: 10px;
    margin-top: 15px;
  }

</style>
</head>
<body>

<h1>â˜• Coffee Menu</h1>

<!-- Coffee Items -->
<div class="menu-item">
  <div class="menu-left">
    <img src="https://ungroundedcoffee.com/image/cache/data/Products/Beverage/IcedAmericano-600x600-500x500.jpg" alt="Americano">
    <div class="menu-info">
      <strong>Americano</strong>
      <span>$1.5</span>
    </div>
  </div>
  <div class="menu-right">
    <select id="sugar_americano">
      <option>No sugar</option><option>Normal</option><option>Extra sugar</option>
    </select>
    <select id="ice_americano">
      <option>Less ice</option><option>Normal ice</option><option>Extra ice</option>
    </select>
    <input id="qty_americano" type="number" value="1" min="1">
    <button class="add" onclick="addToCart('Americano', 1.5)">Add</button>
  </div>
</div>

<div class="menu-item">
  <div class="menu-left">
    <img src="https://ungroundedcoffee.com/image/cache/data/Products/Beverage/Iced-Latte-Ungrounded-Coffee-500x500.jpeg" alt="Latte">
    <div class="menu-info">
      <strong>Latte</strong>
      <span>$1.5</span>
    </div>
  </div>
  <div class="menu-right">
    <select id="sugar_latte">
      <option>No sugar</option><option>Normal</option><option>Extra sugar</option>
    </select>
    <select id="ice_latte">
      <option>Less ice</option><option>Normal ice</option><option>Extra ice</option>
    </select>
    <input id="qty_latte" type="number" value="1" min="1">
    <button class="add" onclick="addToCart('Latte', 1.5)">Add</button>
  </div>
</div>

<div class="menu-item">
  <div class="menu-left">
    <img src="https://ungroundedcoffee.com/image/cache/data/00042-500x500.jpg" alt="Cappuccino">
    <div class="menu-info">
      <strong>Cappuccino</strong>
      <span>$2</span>
    </div>
  </div>
  <div class="menu-right">
    <select id="sugar_cappuccino">
      <option>No sugar</option><option>Normal</option><option>Extra sugar</option>
    </select>
    <select id="ice_cappuccino">
      <option>Less ice</option><option>Normal ice</option><option>Extra ice</option>
    </select>
    <input id="qty_cappuccino" type="number" value="1" min="1">
    <button class="add" onclick="addToCart('Cappuccino', 2)">Add</button>
  </div>
</div>

<!-- Floating Cart -->
<div class="cart-btn" onclick="openCart()">
  ðŸ›’
  <span class="cart-count" id="cartCount">0</span>
</div>

<!-- Popup: Cart -->
<div class="popup-bg" id="cartPopup">
  <div class="popup">
    <h2>Your Cart</h2>
    <div id="cartDetails"></div>
    <button onclick="showPayment()">Checkout</button>
    <button class="close-btn" onclick="closePopup('cartPopup')">Close</button>
  </div>
</div>

<!-- Popup: Payment -->
<div class="popup-bg" id="paymentPopup">
  <div class="popup">
    <h2>Scan QR to Pay</h2>
    <img class="qr" src="IMG_2032.jpeg" alt="QR Code">
    <p id="totalText"></p>
    <button onclick="finishOrder()">I Have Paid</button>
    <button class="close-btn" onclick="closePopup('paymentPopup')">Cancel</button>
  </div>
</div>

<script>
  let cart = [];

  function addToCart(name, price) {
    const sugar = document.getElementById('sugar_' + name.toLowerCase()).value;
    const ice = document.getElementById('ice_' + name.toLowerCase()).value;
    const qty = parseInt(document.getElementById('qty_' + name.toLowerCase()).value);
    cart.push({ name, price, sugar, ice, qty });
    updateCartCount();
  }

  function updateCartCount() {
    document.getElementById('cartCount').innerText = cart.length;
  }

  function openCart() {
    if (cart.length === 0) {
      alert("Your cart is empty!");
      return;
    }
    const details = cart.map(i => 
      `${i.name} x${i.qty} (${i.sugar}, ${i.ice}) - $${(i.price * i.qty).toFixed(2)}`
    ).join("<br>");
    document.getElementById('cartDetails').innerHTML = details;
    document.getElementById('cartPopup').style.display = 'flex';
  }

  function closePopup(id) {
    document.getElementById(id).style.display = 'none';
  }

  function showPayment() {
    document.getElementById('cartPopup').style.display = 'none';
    const total = cart.reduce((sum, i) => sum + i.price * i.qty, 0);
    document.getElementById('totalText').innerText = "Total: $" + total.toFixed(2);
    document.getElementById('paymentPopup').style.display = 'flex';
  }

  function finishOrder() {
    const total = cart.reduce((sum, i) => sum + i.price * i.qty, 0);
    if (window.Telegram && Telegram.WebApp) {
      Telegram.WebApp.sendData(JSON.stringify({ order: cart, paid: true, total }));
    } else {
      alert("Order submitted (test mode). Total: $" + total.toFixed(2));
    }
    cart = [];
    updateCartCount();
    closePopup('paymentPopup');
  }
</script>

</body>
</html>
